function typeOf(a){var s=typeof a;if(s==='object'){if(a){if(typeof a.length==='number'&&!(a.propertyIsEnumerable('length'))&&typeof a.splice==='function'){s='array'}}else{s='null'}}return s}function isEmpty(o){var i,v;if(typeOf(o)==='object'){for(i in o){v=o[i];if(v!==undefined&&typeOf(v)!=='function'){return false}}}return true}if(!String.prototype.entityify){String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}if(!String.prototype.quote){String.prototype.quote=function(){var c,i,l=this.length,o='"';for(i=0;i<l;i+=1){c=this.charAt(i);if(c>=' '){if(c==='\\'||c==='"'){o+='\\'}o+=c}else{switch(c){case'\b':o+='\\b';break;case'\f':o+='\\f';break;case'\n':o+='\\n';break;case'\r':o+='\\r';break;case'\t':o+='\\t';break;default:c=c.charCodeAt();o+='\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16)}}}return o+'"'}}if(!String.prototype.supplant){String.prototype.supplant=function(o){return this.replace(/{([^{}]*)}/g,function(a,b){var r=o[b];return typeof r==='string'||typeof r==='number'?r:a})}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s*(\S*(?:\s+\S+)*)\s*$/,"$1")}}if(!String.prototype.camelize){String.prototype.camelize=function camelize(){var d=this.replace(/([\s|\-|\_|\n])([^\s|\-|\_|\n]?)/g,function(a,b,c){return(c)?c.toUpperCase():''});var e=d.charAt(0),lower=e.toLowerCase();return(e!==lower)?(lower+d.slice(1)):d}}if(!String.prototype.fmt){String.prototype.fmt=function fmt(){var b=arguments;var c=0;return this.replace(/%@([0-9]+)?/g,function(s,a){a=(a)?parseInt(a,0)-1:c++;s=b[a];return((s===null)?'(null)':(s===undefined)?'':s).toString()})}}if(!Array.prototype.uniq){Array.prototype.uniq=function uniq(){var a=[],len=this.length,item,idx;for(idx=0;idx<len;idx++){item=this[idx];if(a.indexOf(item)<0)a.push(item)}return a}}if(!String.prototype.w){String.prototype.w=function w(){var a=[],ary2=this.split(' '),len=ary2.length;for(var b=0;b<len;++b){var c=ary2[b];if(c.length!==0)a.push(c)}return a}}if(!Number.partition){Number.partition=function partition(a,b){var c=[];var d=Math.floor(a/b),rem=a%b;for(var i=0;i<b;++i){c[i]=d+((rem-->0)?1:0)}return c}}if(!Number.prototype.partition){Number.prototype.partition=function partition(a){return Number.partition(this,a)}}if(!String.prototype.truncate){String.prototype.truncate=function truncate(l){return this.slice(0,l)}}if(!String.partition){String.partition=function partition(a,b){var c=a.w();var p=c.length.partition(b),l=p.length,idx=0;for(var i=0;i<l-1;++i){idx+=p[i];c.splice(idx,0,"\n")}return c.join(" ")}}if(!String.prototype.partition){String.prototype.partition=function partition(a){return String.partition(this,a)}}_.mixin({state:function(a){return JSON.parse(JSON.stringify(a))},cleanArray:function(a){if(_.isArray(a)){var b=a.length,i=0;while(i<b){var o=_(a[i]);if(o.isEmpty()||o.isUndefined()||o.isNaN()||o.isNull()){a.splice(i,1);i--;b--}i++}}},areEqual:function(a,b,c){c=c?true:false;return(c&&(a===b))||(!_.isEmpty(a)&&!_.isEmpty(b)&&(a===b))}});(function($){$.fn.centerBox=function(){return this.each(function(){var s=this.style;s.left=(($(window).width()-$(this).width())/2)+"px";s.top=(($(window).height()-$(this).height())/2)+"px"})}})(jQuery);(function($){$.GET=$.getJSON;$.POST=function(a,b,c){return $.post(a,b,c,'json')};$.PUT=function(a,b,c){if($.isFunction(b)){c=b;b={}}return $.post(a,$.extend(b,{_method:'put'}),c,'json')};$.DEL=function(a,b,c){if($.isFunction(b)){c=b;b={}}return $.post(a,$.extend(b,{_method:'delete'}),c,'json')}})(jQuery);(function($){if(typeof($.mouse)!=='undefined'){$._oldMouse=$.mouse}if(typeof($.fn.mouse)!=='undefined'){$.fn._oldMouse=$.fn.mouse}$.mouse=function(a,b){if(typeof(a)==='undefined'){throw new Error("Invalid MouseEvent");}var x,y,doc=document;b=$(b)[0]||a.target;if(typeof(a.offsetX)!=='undefined'&&typeof(a.offsetY)!=='undefined'){x=a.offsetX;y=a.offsetY}else{if(typeof(a.layerX)!=='undefined'&&typeof(a.layerY)!=='undefined'){x=a.layerX;y=a.layerY}else if(typeof(a.pageX)!=='undefined'&&typeof(a.pageY)!=='undefined'){x=a.pageX;y=a.pageY}else{x=a.clientX+doc.body.scrollLeft+doc.documentElement.scrollLeft;y=a.clientY+doc.body.scrollTop+doc.documentElement.scrollTop}x-=$(b)[0].offsetLeft;y-=$(b)[0].offsetTop}return{'x':x,'y':y}};$.fn.mouse=function(a){return $.mouse(a,this)}})(jQuery);(function($){if(typeof($.editable)!=='undefined'){$._oldEditable=$.editable}if(typeof($.fn.editable)!=='undefined'){$.fn._oldEditable=$.fn.editable}$.editable={};$.editable.defaults={finishedEditing:function(){},autoStart:false,toolTip:"Double Click to Edit"};$.fn.editable=function(b){var c=$.extend({},$.editable.defaults,b);function editable(){var a=$(this);a.bind('dblclick.edit',startEditing);a.blur(stopEditing);a.addClass("editable");a.attr("title",c.toolTip);function startEditing(){a.attr("contenteditable","true");a.addClass("editing");a.focus();return false}function stopEditing(){a.attr("contenteditable","false");a.removeClass("editing");if($.isFunction(c.finishedEditing)){c.finishedEditing.call(this)}return false}if(c.autoStart){startEditing()}}return this.each(editable)}})(jQuery);(function($){if(typeof($.drawable)!=='undefined'){$._oldDrawable=$.drawable}if(typeof($.fn.drawable)!=='undefined'){$.fn._oldDrawable=$.fn.drawable}$.drawable={};$.drawable.defaults={};$.fn.drawable=function(k){var l=function(b){var c=$(this);if(c.is("canvas")){c.isDrawable=false;var d=c[0].getContext("2d");var f=false;d.strokeStyle="#000000";var g=function(a){a.preventDefault();f=true;d.beginPath();var p=$(c).mouse(a),x=p.x,y=p.y;d.moveTo(x,y)};var h=function(a){a.preventDefault();var p=$(c).mouse(a),x=p.x,y=p.y;if(f){d.lineTo(x,y);d.stroke()}};var i=function(a){a.preventDefault();f=false};if(b.enable||!b.disable){try{c.draggable('disable')}catch(e){}$(document).addClass("drawing-active");c.addClass("drawable");c.bind({'mousedown.draw':g,'mouseup.draw':i,'mousemove.draw':h})}else if(b.disable||!b.enable){$(document).removeClass("drawing-active")c.removeClass("drawable");c.unbind('mousedown.draw');c.unbind('mouseup.draw');c.unbind('mousemove.draw');try{c.draggable('enable')}catch(e){}var j=c.data();j.bitmap=c[0].toDataURL();c.data(j)}}else{throw new Error("Only <canvas> elements are drawable!");}};this.each(function(){l.call(this,k)});return this}})(jQuery);
